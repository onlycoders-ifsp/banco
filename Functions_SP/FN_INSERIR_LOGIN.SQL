CREATE OR REPLACE FUNCTION FN_INSERIR_LOGIN(P_ID_USUARIO UUID, P_SENHA TEXT, P_ID_LOGIN VARCHAR(50))
RETURNS BOOLEAN AS $$
DECLARE STATE TEXT;
DECLARE ERRO TEXT;
BEGIN
	INSERT INTO AUTENTIFICACAO(ID_USUARIO, PASSWORD, LOGIN)
	VALUES(P_ID_USUARIO, CRYPT(P_SENHA,CONCAT(gen_salt('bf',16),TO_CHAR(CURRENT_TIMESTAMP,'YYYYMMDDHHMMSSMSUS'))), P_ID_LOGIN);
	RETURN TRUE;
	
	EXCEPTION WHEN OTHERS THEN
		PERFORM FN_REPORT_ERRO('ERRO AO INSERIR LOGIN', sqlstate, sqlerrm);
		RETURN FALSE;
END;
$$  LANGUAGE plpgsql