CREATE OR REPLACE FUNCTION FN_RETORNA_USUARIO(USUARIO UUID)
RETURNS SETOF RECORD AS $$
DECLARE
RECORD_SET RECORD;
BEGIN
	FOR
		RECORD_SET IN SELECT NOME, CPF, LOGRADOURO, NUMERO, CEP, EMAIL, S.DESCRICAO, 
		T.TELEFONE[1] TELEFONE, T.TELEFONE[2] CELULAR, U.DATA_INCLUSAO
		FROM USUARIOS U
		INNER JOIN SEXO S 
		ON U.ID_SEXO = S.ID_SEXO
		INNER JOIN TELEFONES T
		ON T.ID_USUARIO = U.ID_USUARIO
		WHERE U.ID_USUARIO = USUARIO
		
		LOOP
			RETURN NEXT RECORD_SET;
		END LOOP;
	RETURN;
END;
$$ language 'plpgsql';

/*
SELECT *FROM FN_RETORNA_USUARIO('fc638b3d-cdec-4a94-9177-2d583effec33')
			AS T(NOME TEXT, CPF VARCHAR(14), LOGRADOURO TEXT, NUMERO VARCHAR(10), CEP CHAR(10), 
				 EMAIL VARCHAR(100), SEXO TEXT, TELEFONE TEXT, CELULAR TEXT, DATA_INCLUSAO TIMESTAMPTZ);
*/