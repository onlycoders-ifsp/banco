CREATE OR REPLACE FUNCTION FN_ATIVA_INATIVA_USUARIO(P_ID_USUARIO TEXT)
RETURNS BOOLEAN AS $$
BEGIN
	
	UPDATE USUARIOS
	SET IS_DELETADO = CASE IS_DELETADO
						WHEN TRUE THEN FALSE
						ELSE TRUE
					END
	WHERE ID_USUARIO = UUID(P_ID_USUARIO);
	
	RETURN TRUE;
	
	EXCEPTION WHEN OTHERS THEN
		PERFORM FN_REPORT_ERRO('ERRO AO DELETAR USUARIO', SQLSTATE, SQLERRM, 'FN_DELETA_USUARIO', 'USUARIOS', CURRENT_QUERY());
		RETURN FALSE;
END;
$$ LANGUAGE PLPGSQL;

/*
SELECT FN_DELETA_USUARIO('8E7578B4-79DD-47F7-9C80-B0B7917166AB')
*/