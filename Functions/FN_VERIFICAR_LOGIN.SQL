CREATE OR REPLACE FUNCTION FN_VERIFCAR_LOGIN(P_LOGIN VARCHAR(50), P_SENHA TEXT)
RETURNS TEXT AS $$
DECLARE IS_CORRECT BOOLEAN;
DECLARE USUARIO TEXT;
BEGIN
	SELECT (AUTENTIFICACAO.PASSWORD = CRYPT(P_SENHA,AUTENTIFICACAO.PASSWORD)), USUARIOS.ID_USUARIO 
	INTO IS_CORRECT, USUARIO
	FROM AUTENTIFICACAO
	WHERE LOGIN = P_LOGIN;
	
	IF IS_CORRECT THEN
		RETURN USUARIO;
	ELSE 
		RETURN NULL;
	END IF;
	
	EXCEPTION WHEN OTHERS THEN
		PERFORM FN_REPORT_ERRO('ERRO AO VERIFICAR O LOGIN', sqlstate, sqlerrm);
		RETURN FALSE;
END;
$$  LANGUAGE plpgsql

/*
SELECT FN_VERIFCAR_LOGIN('testedebancov4@alugo.com', 'aaabbbccc')
*/