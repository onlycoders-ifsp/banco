CREATE OR REPLACE FUNCTION FN_DELETA_PRODUTO(P_ID_PRODUTO TEXT)
RETURNS BOOLEAN AS $$
BEGIN

	UPDATE PRODUTOS
	SET ATIVO = CASE ATIVO
					WHEN TRUE THEN FALSE
					ELSE TRUE
	WHERE ID_PRODUTO =  UUID(P_ID_PRODUTO);
	
	RETURN TRUE;
	
	EXCEPTION WHEN OTHERS THEN
		PERFORM FN_REPORT_ERRO('ERRO AO ATUALIZAR PRODUTO', SQLSTATE, SQLERRM, 'FN_DELETA_PRODUTO', 'PRODUTOS', CURRENT_QUERY());
		RETURN FALSE;
END;
$$ LANGUAGE PLPGSQL;

/*
SELECT FN_DELETA_PRODUTO('98f7ff8b-102d-495d-8357-900957fb586b')
*/